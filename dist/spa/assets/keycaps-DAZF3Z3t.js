import{_ as V,Q as h,g}from"./_plugin-vue_export-helper-CebnR4Md.js";import{o as D,e as C,g as k,f as Q,Q as B}from"./selection-CZG0j1HS.js";import{d as N,Q as q,a as M,C as y,b as J,c as L}from"./vuedraggable.umd-DiUN3mcd.js";import{Q as E,k as d,a as x,b as O,c as v,d as P}from"./keycaps-DWBb30El.js";import{C as T,K as z}from"./ColorFilter-BCGj6cdg.js";import{G as p,H as u,I as t,J as S,M as i,K as s,N as G,O as F,k as _,L as f,P as m}from"./index-joG1CFgz.js";const U={name:"PageIndex",components:{draggable:N,KeycapColorExtractor:z,ColorFilter:T},data(){return{searchQuery:"",keycaps:[],previewDialog:!1,selectedKeycap:null,sortOrder:"asc",drag:!1,selectedColors:[]}},created(){this.keycaps=d.getAllKeycaps();const e=localStorage.getItem("keycapsOrder");if(e){const c=JSON.parse(e).map(o=>o.id);this.keycaps.sort((o,a)=>c.indexOf(o.id)-c.indexOf(a.id))}const r=d.getFavorites();this.keycaps=this.keycaps.map(c=>({...c,isFavorite:r.some(o=>o.id===c.id)}));const n=d.getShopping();this.keycaps=this.keycaps.map(c=>({...c,isShopping:n.some(o=>o.id===c.id)}))},watch:{keycaps:{handler(e){localStorage.setItem("keycapsOrder",JSON.stringify(e))},deep:!0}},computed:{filteredKeycaps:{get(){return this.drag?this.keycaps:this.keycaps.filter(e=>{const r=this.searchQuery.toLowerCase(),n=e.name.toLowerCase().includes(r)||e.manufacturer.toLowerCase().includes(r);let c=!0;return this.selectedColors.length>0&&(c=this.selectedColors.some(o=>e.colorCategory&&e.colorCategory.includes(o))),n&&c}).sort((e,r)=>this.sortOrder==="asc"?e.id-r.id:r.id-e.id)},set(e){this.keycaps=e}}},methods:{toggleFavorite(e){e.isFavorite=!e.isFavorite,e.isFavorite?d.addToFavorites(e):d.removeFromFavorites(e.id)},toggleShopping(e){e.isShopping=!e.isShopping,e.isShopping?d.addToShopping(e):d.removeFromShopping(e.id)},showPreview(e){this.selectedKeycap=e,this.previewDialog=!0},toggleSort(){this.sortOrder==="asc"?this.sortOrder="desc":this.sortOrder==="desc"&&(this.sortOrder="asc");const e=[...this.keycaps].sort((r,n)=>this.sortOrder==="asc"?r.id-n.id:n.id-r.id);this.keycaps=e,localStorage.setItem("keycapsOrder",JSON.stringify(e))},onDragEnd(){this.drag=!1,localStorage.setItem("keycapsOrder",JSON.stringify(this.keycaps))},onClear(){this.searchQuery=""},filterByManufacturer(e){this.searchQuery=e},handleColorFilter(e){this.selectedColors=e}}},A={class:"row q-mb-md items-center"},H={class:"col-grow"},j={class:"col-auto q-ml-md"},R={key:0,class:"text-center q-pa-md"},W={class:"col-12 col-sm-6 col-md-4 col-lg-3"},X={class:"drag-handle"},Y={class:"text-h6"},Z={class:"text-subtitle2"},$={class:"text-h6",style:{color:"var(--secondary-color)"}},ee={class:"row items-center"},re={class:"col-12 col-sm-6"},se={class:"text-subtitle1"},oe={class:"col-12 col-sm-6"};function te(e,r,n,c,o,a){const b=S("color-filter"),w=S("keycap-color-extractor"),I=S("draggable");return u(),p(E,{class:"q-pa-md"},{default:t(()=>[r[11]||(r[11]=i("h1",{class:"text-h4 q-mb-md"},"Keycaps Collection",-1)),i("div",A,[i("div",H,[s(q,{modelValue:o.searchQuery,"onUpdate:modelValue":r[3]||(r[3]=l=>o.searchQuery=l),filled:"",placeholder:"搜索键帽名称或制造商",clearable:"",onClear:a.onClear},{append:t(()=>[s(h,{name:"search"})]),hint:t(()=>[f(" 已找到 "+m(a.filteredKeycaps.length)+" 个键帽 ",1)]),after:t(()=>[s(M,{flat:"",dense:"",style:{color:"var(--secondary-color)"},label:"快速筛选"},{default:t(()=>[s(D,null,{default:t(()=>[_((u(),p(C,{clickable:"",style:{color:"var(--secondary-color)"},onClick:r[0]||(r[0]=l=>a.filterByManufacturer("GMK"))},{default:t(()=>[s(k,null,{default:t(()=>[s(Q,null,{default:t(()=>r[7]||(r[7]=[f("GMK")])),_:1})]),_:1})]),_:1})),[[y]]),_((u(),p(C,{clickable:"",style:{color:"var(--secondary-color)"},onClick:r[1]||(r[1]=l=>a.filterByManufacturer("JTK"))},{default:t(()=>[s(k,null,{default:t(()=>[s(Q,null,{default:t(()=>r[8]||(r[8]=[f("JTK")])),_:1})]),_:1})]),_:1})),[[y]]),s(B),_((u(),p(C,{clickable:"",style:{color:"var(--secondary-color)"},onClick:r[2]||(r[2]=l=>o.searchQuery="")},{default:t(()=>[s(k,null,{default:t(()=>[s(Q,null,{default:t(()=>r[9]||(r[9]=[f("显示全部")])),_:1})]),_:1})]),_:1})),[[y]])]),_:1})]),_:1})]),_:1},8,["modelValue","onClear"])]),i("div",j,[s(g,{flat:"",style:{color:"var(--secondary-color)"},class:"sort-btn",onClick:a.toggleSort},{default:t(()=>[s(h,{name:o.sortOrder==="asc"?"arrow_upward":"arrow_downward",class:"q-mr-sm"},null,8,["name"]),f(" ID "+m(o.sortOrder==="asc"?"升序":"降序"),1)]),_:1},8,["onClick"])])]),s(b,{keycaps:o.keycaps,onFilterChange:a.handleColorFilter},null,8,["keycaps","onFilterChange"]),o.searchQuery&&a.filteredKeycaps.length===0?(u(),G("div",R,[s(h,{name:"search_off",size:"48px",style:{color:"var(--secondary-color)"}}),r[10]||(r[10]=i("p",{class:"text",style:{color:"var(--secondary-color)"}},"未找到匹配的键帽",-1))])):F("",!0),s(I,{modelValue:a.filteredKeycaps,"onUpdate:modelValue":r[4]||(r[4]=l=>a.filteredKeycaps=l),class:"row q-col-gutter-md",style:{color:"var(--secondary-color)"},"item-key":"id",onStart:r[5]||(r[5]=l=>o.drag=!0),onEnd:a.onDragEnd,group:{name:"keycaps"}},{item:t(({element:l})=>[i("div",W,[s(x,{class:"keycap-card",style:{"background-color":"var(--l9)"}},{default:t(()=>[i("div",X,[s(h,{name:"drag_indicator",size:"sm",class:"cursor-move"})]),s(O,{src:l.image,class:"keycap-image",ratio:1},null,8,["src"]),s(v,null,{default:t(()=>[i("div",Y,m(l.name),1),i("div",Z,m(l.manufacturer),1),s(w,{"image-src":l.image},null,8,["image-src"])]),_:2},1024),s(P,{align:"right"},{default:t(()=>[s(g,{icon:"zoom_in",flat:"",round:"",onClick:K=>a.showPreview(l),style:{color:"var(--secondary-color)"}},null,8,["onClick"]),s(g,{icon:l.isFavorite?"favorite":"favorite_border",flat:"",round:"",onClick:K=>a.toggleFavorite(l),color:l.isFavorite?"red":"grey"},null,8,["icon","onClick","color"]),s(g,{icon:l.isShopping?"shopping_cart":"add_shopping_cart",flat:"",round:"",onClick:K=>a.toggleShopping(l),color:l.isShopping?"red":"grey"},null,8,["icon","onClick","color"])]),_:2},1024)]),_:2},1024)])]),_:1},8,["modelValue","onEnd"]),s(J,{modelValue:o.previewDialog,"onUpdate:modelValue":r[6]||(r[6]=l=>o.previewDialog=l)},{default:t(()=>[s(x,{class:"preview-card"},{default:t(()=>[s(v,{class:"row items-center q-pb-none"},{default:t(()=>[i("div",$,m(o.selectedKeycap?.name),1),s(L),_(s(g,{style:{color:"var(--secondary-color)"},icon:"close",flat:"",round:"",dense:""},null,512),[[y]])]),_:1}),s(v,null,{default:t(()=>[s(O,{src:o.selectedKeycap?.image,style:{"max-height":"80vh"},fit:"contain"},null,8,["src"])]),_:1}),s(v,null,{default:t(()=>[i("div",ee,[i("div",re,[i("div",se,"制造商: "+m(o.selectedKeycap?.manufacturer),1)]),i("div",oe,[o.selectedKeycap?(u(),p(w,{key:0,"image-src":o.selectedKeycap.image},null,8,["image-src"])):F("",!0)])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const ue=V(U,[["render",te],["__scopeId","data-v-a2411caa"]]);export{ue as default};
