import{_ as $,g as z,f as R,i as O,j as M,k as F,Q as B,l as I,u as D,c as E,e as j,R as K}from"./_plugin-vue_export-helper-DoYapf4v.js";import{N as C,H as p,M as S,Q as T,R as A,S as Q,c as V,a as f,h as y,g as N,m as P,O as H,K as w,G as L,I as W,L as G,P as U}from"./index-CsPf3d5g.js";import{u as J,e as X,f as Y}from"./vuedraggable.umd-BXLkE0Fg.js";const Z={name:"KeycapColorExtractor",props:{imageSrc:{type:String,required:!0}},data(){return{extractedColors:[]}},watch:{imageSrc:{immediate:!0,handler(e){e&&this.extractColorsFromImage(e)}}},methods:{extractColorsFromImage(e){this.extractedColors=["#555555","#eeeeee","#777777","#cccccc","#999999"];const l=new Image;l.crossOrigin="Anonymous",l.onload=()=>{const s=document.createElement("canvas"),i=s.getContext("2d"),c=200;let n=l.width,d=l.height;n>d&&n>c?(d=Math.round(d*(c/n)),n=c):d>c&&(n=Math.round(n*(c/d)),d=c),s.width=n,s.height=d,i.drawImage(l,0,0,n,d);const x=i.getImageData(0,0,n,d).data,g=this.extractDominantColors(x,5);g.length>0&&(this.extractedColors=g)},l.onerror=()=>{console.error("Error loading image for color extraction")};let o=e;e.startsWith("public/")&&(o=e.replace("public/","/")),l.src=o+"?t="+new Date().getTime()},extractDominantColors(e,l){const o={},s=e.length/4,i=Math.max(1,Math.floor(s/1e4));for(let t=0;t<e.length;t+=4*i){const a=e[t],h=e[t+1],v=e[t+2];if(e[t+3]<128||this.isBackgroundColor(a,h,v))continue;const u=Math.round(a/16)*16,k=Math.round(h/16)*16,q=Math.round(v/16)*16,_=`${u},${k},${q}`;o[_]?(o[_].count++,o[_].saturation+=this.calculateSaturation(a,h,v),o[_].brightness+=this.calculateBrightness(a,h,v)):o[_]={color:`#${this.componentToHex(u)}${this.componentToHex(k)}${this.componentToHex(q)}`,count:1,r:u,g:k,b:q,saturation:this.calculateSaturation(a,h,v),brightness:this.calculateBrightness(a,h,v)}}let c=Object.values(o);c.forEach(t=>{t.saturation/=t.count,t.brightness/=t.count}),c.sort((t,a)=>a.count-t.count),c=c.slice(0,20);const n=c.filter(t=>t.brightness<.6).sort((t,a)=>a.count-t.count),d=n.length>0?n[0].color:c[0].color,x=c.filter(t=>t.brightness>.7||t.saturation>.7).filter(t=>t.color!==d).sort((t,a)=>a.saturation+a.brightness-(t.saturation+t.brightness)),g=x.length>0?x[0].color:"#FFFFFF",b=c.filter(t=>t.color!==d&&t.color!==g&&t.saturation>.4).sort((t,a)=>a.saturation-t.saturation),m=[d,g];for(let t=0;t<Math.min(3,b.length);t++)m.push(b[t].color);for(;m.length<l&&c.length>m.length;){const t=c.find(a=>!m.includes(a.color));if(t)m.push(t.color);else break}return m},componentToHex(e){const l=e.toString(16);return l.length===1?"0"+l:l},calculateSaturation(e,l,o){const s=Math.max(e,l,o),i=Math.min(e,l,o);return s===0?0:(s-i)/s},calculateBrightness(e,l,o){return(e+l+o)/(3*255)},isBackgroundColor(e,l,o){const s=this.calculateBrightness(e,l,o),i=this.calculateSaturation(e,l,o);return s>.95&&i<.1||s<.05}}},ee={class:"keycap-colors-container"},te={class:"keycap-color-sample"},le={class:"color-samples"},oe=["title"];function ae(e,l,o,s,i,c){return p(),C("div",ee,[S("div",te,[l[0]||(l[0]=S("div",{class:"color-sample-title"},"键帽颜色",-1)),S("div",le,[(p(!0),C(T,null,A(i.extractedColors,(n,d)=>(p(),C("div",{key:d,class:"color-sample",style:Q({backgroundColor:n}),title:n},null,12,oe))),128))])])])}const ye=$(Z,[["render",ae],["__scopeId","data-v-4ffdd574"]]),ne=V({name:"QBtnToggle",props:{...J,modelValue:{required:!0},options:{type:Array,required:!0,validator:e=>e.every(l=>("label"in l||"icon"in l||"slot"in l)&&"value"in l)},color:String,textColor:String,toggleColor:{type:String,default:"primary"},toggleTextColor:String,outline:Boolean,flat:Boolean,unelevated:Boolean,rounded:Boolean,push:Boolean,glossy:Boolean,size:String,padding:String,noCaps:Boolean,noWrap:Boolean,dense:Boolean,readonly:Boolean,disable:Boolean,stack:Boolean,stretch:Boolean,spread:Boolean,clearable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","clear","click"],setup(e,{slots:l,emit:o}){const s=f(()=>e.options.find(t=>t.value===e.modelValue)!==void 0),i=f(()=>({type:"hidden",name:e.name,value:e.modelValue})),c=Y(i),n=f(()=>O(e)),d=f(()=>({rounded:e.rounded,dense:e.dense,...n.value})),x=f(()=>e.options.map((t,a)=>{const{attrs:h,value:v,slot:r,...u}=t;return{slot:r,props:{key:a,"aria-pressed":v===e.modelValue?"true":"false",...h,...u,...d.value,disable:e.disable===!0||u.disable===!0,color:v===e.modelValue?b(u,"toggleColor"):b(u,"color"),textColor:v===e.modelValue?b(u,"toggleTextColor"):b(u,"textColor"),noCaps:b(u,"noCaps")===!0,noWrap:b(u,"noWrap")===!0,size:b(u,"size"),padding:b(u,"padding"),ripple:b(u,"ripple"),stack:b(u,"stack")===!0,stretch:b(u,"stretch")===!0,onClick(k){g(v,t,k)}}}}));function g(t,a,h){e.readonly!==!0&&(e.modelValue===t?e.clearable===!0&&(o("update:modelValue",null,null),o("clear")):o("update:modelValue",t,a),o("click",h))}function b(t,a){return t[a]===void 0?e[a]:t[a]}function m(){const t=x.value.map(a=>y(z,a.props,a.slot!==void 0?l[a.slot]:void 0));return e.name!==void 0&&e.disable!==!0&&s.value===!0&&c(t,"push"),R(l.default,t)}return()=>y(X,{class:"q-btn-toggle",...n.value,rounded:e.rounded,stretch:e.stretch,glossy:e.glossy,spread:e.spread},m)}}),ce=V({name:"QAvatar",props:{...M,fontSize:String,color:String,textColor:String,icon:String,square:Boolean,rounded:Boolean},setup(e,{slots:l}){const o=F(e),s=f(()=>"q-avatar"+(e.color?` bg-${e.color}`:"")+(e.textColor?` text-${e.textColor} q-chip--colored`:"")+(e.square===!0?" q-avatar--square":e.rounded===!0?" rounded-borders":"")),i=f(()=>e.fontSize?{fontSize:e.fontSize}:null);return()=>{const c=e.icon!==void 0?[y(B,{name:e.icon})]:void 0;return y("div",{class:s.value,style:o.value},[y("div",{class:"q-avatar__content row flex-center overflow-hidden",style:i.value},I(l.default,c))])}}}),re={xs:8,sm:10,md:14,lg:20,xl:24},se=V({name:"QChip",props:{...D,...M,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:l,emit:o}){const{proxy:{$q:s}}=N(),i=E(e,s),c=F(e,re),n=f(()=>e.selected===!0||e.icon!==void 0),d=f(()=>e.selected===!0?e.iconSelected||s.iconSet.chip.selected:e.icon),x=f(()=>e.iconRemove||s.iconSet.chip.remove),g=f(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),b=f(()=>{const r=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(r?` text-${r} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(g.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(i.value===!0?" q-chip--dark q-dark":"")}),m=f(()=>{const r=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},u={...r,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||s.lang.label.remove};return{chip:r,remove:u}});function t(r){r.keyCode===13&&a(r)}function a(r){e.disable||(o("update:selected",!e.selected),o("click",r))}function h(r){(r.keyCode===void 0||r.keyCode===13)&&(P(r),e.disable===!1&&(o("update:modelValue",!1),o("remove")))}function v(){const r=[];g.value===!0&&r.push(y("div",{class:"q-focus-helper"})),n.value===!0&&r.push(y(B,{class:"q-chip__icon q-chip__icon--left",name:d.value}));const u=e.label!==void 0?[y("div",{class:"ellipsis"},[e.label])]:void 0;return r.push(y("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},I(l.default,u))),e.iconRight&&r.push(y(B,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&r.push(y(B,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:x.value,...m.value.remove,onClick:h,onKeyup:h})),r}return()=>{if(e.modelValue===!1)return;const r={class:b.value,style:c.value};return g.value===!0&&Object.assign(r,m.value.chip,{onClick:a,onKeyup:t}),j("div",r,v(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[K,e.ripple]])}}}),ie={name:"ColorFilter",props:{keycaps:{type:Array,required:!0}},data(){return{selectedColors:[],colorType:"all",colorMap:[{value:"red",label:"红色",color:"#e53935",type:["base","text","accent"]},{value:"crimson",label:"深红",color:"#d32f2f",type:["base","accent"]},{value:"burgundy",label:"酒红",color:"#8b0000",type:["base"]},{value:"coral",label:"珊瑚红",color:"#ff7043",type:["text","accent"]},{value:"orange",label:"橙色",color:"#ff9800",type:["text","accent"]},{value:"amber",label:"琥珀",color:"#ffa000",type:["text","accent"]},{value:"gold",label:"金色",color:"#ffd700",type:["text","accent"]},{value:"yellow",label:"黄色",color:"#ffeb3b",type:["text","accent"]},{value:"green",label:"绿色",color:"#4caf50",type:["base","text","accent"]},{value:"teal",label:"青绿",color:"#009688",type:["base","accent"]},{value:"mint",label:"薄荷绿",color:"#00bfa5",type:["text","accent"]},{value:"olive",label:"橄榄绿",color:"#827717",type:["base","text"]},{value:"lime",label:"青柠",color:"#cddc39",type:["text","accent"]},{value:"neon-green",label:"霓虹绿",color:"#76ff03",type:["text"]},{value:"blue",label:"蓝色",color:"#2196f3",type:["base","text","accent"]},{value:"navy",label:"藏青",color:"#3d5a80",type:["base"]},{value:"cyan",label:"青色",color:"#00bcd4",type:["text","accent"]},{value:"sky",label:"天蓝",color:"#03a9f4",type:["text","accent"]},{value:"indigo",label:"靛蓝",color:"#3f51b5",type:["base","accent"]},{value:"purple",label:"紫色",color:"#9c27b0",type:["base","accent"]},{value:"violet",label:"紫罗兰",color:"#673ab7",type:["base","accent"]},{value:"lavender",label:"薰衣草",color:"#b39ddb",type:["text","accent"]},{value:"magenta",label:"洋红",color:"#e91e63",type:["text","accent"]},{value:"pink",label:"粉色",color:"#e91e63",type:["text","accent"]},{value:"rose",label:"玫瑰",color:"#f06292",type:["text","accent"]},{value:"blush",label:"腮红",color:"#f8bbd0",type:["text","accent"]},{value:"brown",label:"棕色",color:"#795548",type:["base","text"]},{value:"coffee",label:"咖啡",color:"#6d4c41",type:["base"]},{value:"tan",label:"棕褐",color:"#d7ccc8",type:["text"]},{value:"black",label:"黑色",color:"#212121",type:["base"]},{value:"grey",label:"灰色",color:"#9e9e9e",type:["text"]},{value:"silver",label:"银色",color:"#bdbdbd",type:["text"]},{value:"white",label:"白色",color:"#f5f5f5",type:["text"]},{value:"dark",label:"暗色",color:"#424242",type:["base"]},{value:"bright",label:"亮色",color:"#bbdefb",type:["text"]},{value:"pastel",label:"柔和",color:"#f8bbd0",type:["text","accent"]},{value:"neon",label:"霓虹",color:"#76ff03",type:["text","accent"]},{value:"earth",label:"大地色",color:"#8d6e63",type:["base"]},{value:"warm",label:"暖色",color:"#ff7043",type:["text","accent"]},{value:"cool",label:"冷色",color:"#4fc3f7",type:["base","text","accent"]},{value:"contrast",label:"对比色",color:"#7e57c2",type:["base","text","accent"]},{value:"monochrome",label:"单色",color:"#757575",type:["base","text"]},{value:"halloween",label:"万圣节",color:"#ff5722",type:["base","text","accent"]}]}},computed:{filteredColors(){const e=new Set;this.keycaps.forEach(o=>{o.colorCategory&&Array.isArray(o.colorCategory)&&o.colorCategory.forEach(s=>e.add(s))});let l=this.colorMap;return this.colorType!=="all"&&(l=this.colorMap.filter(o=>o.type&&o.type.includes(this.colorType))),l.filter(o=>e.has(o.value)).map(o=>({...o,selected:this.selectedColors.includes(o.value)}))}},methods:{toggleColor(e){this.selectedColors.includes(e)?this.selectedColors=this.selectedColors.filter(l=>l!==e):this.selectedColors.push(e),this.$emit("filter-change",this.selectedColors)},clearFilters(){this.selectedColors=[],this.$emit("filter-change",this.selectedColors)}}},ue={class:"color-filter-container q-mb-md"},de={class:"color-type-selector q-mb-sm"},be={class:"color-filter-chips"},he={key:0,class:"q-mt-sm"};function ve(e,l,o,s,i,c){return p(),C("div",ue,[l[1]||(l[1]=S("div",{class:"text-subtitle1 q-mb-sm"},"按颜色筛选",-1)),S("div",de,[w(ne,{modelValue:i.colorType,"onUpdate:modelValue":l[0]||(l[0]=n=>i.colorType=n),"toggle-color":"primary",options:[{label:"全部",value:"all"},{label:"底色",value:"base"},{label:"字符色",value:"text"},{label:"点缀色",value:"accent"}],dense:"",unelevated:"",class:"full-width"},null,8,["modelValue"])]),S("div",be,[(p(!0),C(T,null,A(c.filteredColors,n=>(p(),L(se,{key:n.value,selected:i.selectedColors.includes(n.value),color:n.selected?"primary":"","text-color":n.selected?"white":"",clickable:"",onClick:d=>c.toggleColor(n.value),class:"color-chip"},{default:W(()=>[w(ce,{style:Q({backgroundColor:n.color})},null,8,["style"]),G(" "+U(n.label),1)]),_:2},1032,["selected","color","text-color","onClick"]))),128))]),i.selectedColors.length>0?(p(),C("div",he,[w(z,{flat:"",dense:"",size:"sm",color:"primary",label:"清除筛选",onClick:c.clearFilters},null,8,["onClick"])])):H("",!0)])}const xe=$(ie,[["render",ve],["__scopeId","data-v-04372b09"]]);export{xe as C,ye as K};
