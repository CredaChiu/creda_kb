import{_ as x,Q as h,g as m}from"./_plugin-vue_export-helper-DoYapf4v.js";import{o as K,e as _,g as b,f as w,Q as I}from"./selection-DvsxRTGy.js";import{d as F,Q as V,a as D,C as v,b as B,c as N}from"./vuedraggable.umd-BXLkE0Fg.js";import{Q as q,k as c,a as C,b as k,c as Q,d as L}from"./keycaps-BSPX8J5e.js";import{G as y,H as g,I as s,J,M as a,N as M,O as P,K as o,k as p,L as f,P as n}from"./index-CsPf3d5g.js";const E={name:"PageIndex",components:{draggable:F},data(){return{searchQuery:"",keyboard:[],previewDialog:!1,selectedKeyboard:null,sortOrder:"asc",drag:!1}},created(){this.keyboard=c.getAllKeyboard();const e=localStorage.getItem("keyboardOrder");if(e){const d=JSON.parse(e).map(l=>l.id);this.keyboard.sort((l,i)=>d.indexOf(l.id)-d.indexOf(i.id))}const r=c.getFavorites();this.keyboard=this.keyboard.map(d=>({...d,isFavorite:r.some(l=>l.id===d.id)}));const u=c.getShopping();this.keyboard=this.keyboard.map(d=>({...d,isShopping:u.some(l=>l.id===d.id)}))},watch:{keyboard:{handler(e){localStorage.setItem("keyboardOrder",JSON.stringify(e))},deep:!0}},computed:{filteredKeyboard:{get(){return this.drag?this.keyboard:this.keyboard.filter(e=>{const r=this.searchQuery.toLowerCase();return e.name.toLowerCase().includes(r)||e.manufacturer.toLowerCase().includes(r)}).sort((e,r)=>this.sortOrder==="asc"?e.id-r.id:r.id-e.id)},set(e){this.keyboard=e}}},methods:{toggleFavorite(e){e.isFavorite=!e.isFavorite,e.isFavorite?c.addToFavorites(e):c.removeFromFavorites(e.id)},toggleShopping(e){e.isShopping=!e.isShopping,e.isShopping?c.addToShopping(e):c.removeFromShopping(e.id)},showPreview(e){this.selectedKeyboard=e,this.previewDialog=!0},toggleSort(){this.sortOrder==="asc"?this.sortOrder="desc":this.sortOrder==="desc"&&(this.sortOrder="asc");const e=[...this.keyboard].sort((r,u)=>this.sortOrder==="asc"?r.id-u.id:u.id-r.id);this.keyboard=e,localStorage.setItem("keyboardOrder",JSON.stringify(e))},onDragEnd(){this.drag=!1,localStorage.setItem("keyboardOrder",JSON.stringify(this.keyboard))},onClear(){this.searchQuery=""},filterByManufacturer(e){this.searchQuery=e},filterByDesign(e){this.searchQuery=e},filterByLayout(e){this.searchQuery=e}}},T={class:"row q-mb-md items-center"},z={class:"col-grow"},G={class:"col-auto q-ml-md"},U={key:0,class:"text-center q-pa-md"},j={class:"col-12 col-sm-6 col-md-4 col-lg-3"},A={class:"drag-handle"},H={class:"text-h6"},R={class:"row justify-between"},W={class:"text-subtitle2"},X={class:"text-subtitle2"},Y={class:"row justify-between"},Z={class:"text-subtitle2"},$={class:"text-subtitle2"},ee={class:"text-subtitle2 text-right"},re={class:"text-h6",style:{color:"var(--secondary-color)"}};function oe(e,r,u,d,l,i){const O=J("draggable");return g(),y(q,{class:"q-pa-md"},{default:s(()=>[r[11]||(r[11]=a("h1",{class:"text-h4 q-mb-md"},"Keybaord Collection",-1)),a("div",T,[a("div",z,[o(V,{modelValue:l.searchQuery,"onUpdate:modelValue":r[3]||(r[3]=t=>l.searchQuery=t),filled:"",placeholder:"搜索键盘名称、制造商、配列、作者",clearable:"",onClear:i.onClear},{append:s(()=>[o(h,{name:"search"})]),hint:s(()=>[f(" 已找到 "+n(e.filteredKeybaord.length)+" 个键盘 ",1)]),after:s(()=>[o(D,{flat:"",dense:"",style:{color:"var(--secondary-color)"},label:"快速筛选"},{default:s(()=>[o(K,null,{default:s(()=>[p((g(),y(_,{clickable:"",style:{color:"var(--secondary-color)"},onClick:r[0]||(r[0]=t=>i.filterByManufacturer("GMK"))},{default:s(()=>[o(b,null,{default:s(()=>[o(w,null,{default:s(()=>r[7]||(r[7]=[f("GMK")])),_:1})]),_:1})]),_:1})),[[v]]),p((g(),y(_,{clickable:"",style:{color:"var(--secondary-color)"},onClick:r[1]||(r[1]=t=>i.filterByManufacturer("JTK"))},{default:s(()=>[o(b,null,{default:s(()=>[o(w,null,{default:s(()=>r[8]||(r[8]=[f("JTK")])),_:1})]),_:1})]),_:1})),[[v]]),o(I),p((g(),y(_,{clickable:"",style:{color:"var(--secondary-color)"},onClick:r[2]||(r[2]=t=>l.searchQuery="")},{default:s(()=>[o(b,null,{default:s(()=>[o(w,null,{default:s(()=>r[9]||(r[9]=[f("显示全部")])),_:1})]),_:1})]),_:1})),[[v]])]),_:1})]),_:1})]),_:1},8,["modelValue","onClear"])]),a("div",G,[o(m,{flat:"",style:{color:"var(--secondary-color)"},class:"sort-btn",onClick:i.toggleSort},{default:s(()=>[o(h,{name:l.sortOrder==="asc"?"arrow_upward":"arrow_downward",class:"q-mr-sm"},null,8,["name"]),f(" ID "+n(l.sortOrder==="asc"?"升序":"降序"),1)]),_:1},8,["onClick"])])]),l.searchQuery&&e.filteredKeybaord.length===0?(g(),M("div",U,[o(h,{name:"search_off",size:"48px",style:{color:"var(--secondary-color)"}}),r[10]||(r[10]=a("p",{class:"text",style:{color:"var(--secondary-color)"}},"未找到匹配的键盘",-1))])):P("",!0),o(O,{modelValue:i.filteredKeyboard,"onUpdate:modelValue":r[4]||(r[4]=t=>i.filteredKeyboard=t),class:"row q-col-gutter-md",style:{color:"var(--secondary-color)"},"item-key":"id",onStart:r[5]||(r[5]=t=>l.drag=!0),onEnd:i.onDragEnd,group:{name:"keyboard"}},{item:s(({element:t})=>[a("div",j,[o(C,{class:"keyboard-card",style:{"background-color":"var(--l9)"}},{default:s(()=>[a("div",A,[o(h,{name:"drag_indicator",size:"sm",class:"cursor-move"})]),o(k,{src:t.image,class:"keyboard-image",ratio:1},null,8,["src"]),o(Q,null,{default:s(()=>[a("div",H,n(t.name),1),a("div",R,[a("div",W,n(t.design),1),a("div",X,n(t.layout),1)]),a("div",Y,[a("div",Z,n(t.manufacturer),1),a("div",$,n(t.pcb),1)]),a("div",ee,n(t.price),1)]),_:2},1024),o(L,{align:"right"},{default:s(()=>[o(m,{icon:"zoom_in",flat:"",round:"",onClick:S=>i.showPreview(t),style:{color:"var(--secondary-color)"}},null,8,["onClick"]),o(m,{icon:t.isFavorite?"favorite":"favorite_border",flat:"",round:"",onClick:S=>i.toggleFavorite(t),color:t.isFavorite?"red":"grey"},null,8,["icon","onClick","color"]),o(m,{icon:t.isShopping?"shopping_cart":"add_shopping_cart",flat:"",round:"",onClick:S=>i.toggleShopping(t),color:t.isShopping?"red":"grey"},null,8,["icon","onClick","color"])]),_:2},1024)]),_:2},1024)])]),_:1},8,["modelValue","onEnd"]),o(B,{modelValue:l.previewDialog,"onUpdate:modelValue":r[6]||(r[6]=t=>l.previewDialog=t)},{default:s(()=>[o(C,{class:"preview-card"},{default:s(()=>[o(Q,{class:"row items-center q-pb-none"},{default:s(()=>[a("div",re,n(l.selectedKeyboard?.name),1),o(N),p(o(m,{style:{color:"var(--secondary-color)"},icon:"close",flat:"",round:"",dense:""},null,512),[[v]])]),_:1}),o(Q,null,{default:s(()=>[o(k,{src:l.selectedKeyboard?.image,style:{"max-height":"80vh"},fit:"contain"},null,8,["src"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const de=x(E,[["render",oe],["__scopeId","data-v-0593b51e"]]);export{de as default};
