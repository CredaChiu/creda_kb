import{_ as V,Q as y,g}from"./_plugin-vue_export-helper-CebnR4Md.js";import{o as D,e as C,g as k,f as Q,Q as B}from"./selection-CZG0j1HS.js";import{d as N,Q as q,a as M,C as p,b as J,c as L}from"./vuedraggable.umd-DiUN3mcd.js";import{Q as E,k as v,a as x,b as O,c as h,d as P}from"./keycaps-DWBb30El.js";import{C as T,K as z}from"./ColorFilter-BCGj6cdg.js";import{G as m,H as n,I as t,J as w,M as a,K as r,N as G,O as F,k as _,L as f,P as u}from"./index-joG1CFgz.js";const U={name:"PageIndex",components:{draggable:N,KeycapColorExtractor:z,ColorFilter:T},data(){return{searchQuery:"",keycaps:[],previewDialog:!1,selectedKeycap:null,sortOrder:"asc",drag:!1,selectedColors:[]}},created(){this.keycaps=v.getAllKeycaps();const s=localStorage.getItem("keycapsOrder");if(s){const i=JSON.parse(s).map(d=>d.id);this.keycaps.sort((d,o)=>i.indexOf(d.id)-i.indexOf(o.id))}const e=v.getFavorites();this.keycaps=this.keycaps.map(i=>({...i,isFavorite:e.some(d=>d.id===i.id)}))},watch:{keycaps:{handler(s){localStorage.setItem("keycapsOrder",JSON.stringify(s))},deep:!0}},computed:{filteredKeycaps:{get(){return this.drag?this.keycaps:this.keycaps.filter(s=>{const e=this.searchQuery.toLowerCase(),i=s.name.toLowerCase().includes(e)||s.manufacturer.toLowerCase().includes(e);let d=!0;return this.selectedColors.length>0&&(d=this.selectedColors.some(o=>s.colorCategory&&s.colorCategory.includes(o))),i&&d}).sort((s,e)=>this.sortOrder==="asc"?s.id-e.id:e.id-s.id)},set(s){this.keycaps=s}}},methods:{toggleFavorite(s){s.isFavorite=!s.isFavorite,s.isFavorite?v.addToFavorites(s):v.removeFromFavorites(s.id)},showPreview(s){this.selectedKeycap=s,this.previewDialog=!0},toggleSort(){this.sortOrder==="asc"?this.sortOrder="desc":this.sortOrder==="desc"&&(this.sortOrder="asc");const s=[...this.keycaps].sort((e,i)=>this.sortOrder==="asc"?e.id-i.id:i.id-e.id);this.keycaps=s,localStorage.setItem("keycapsOrder",JSON.stringify(s))},onDragEnd(){this.drag=!1,localStorage.setItem("keycapsOrder",JSON.stringify(this.keycaps))},onClear(){this.searchQuery=""},filterByManufacturer(s){this.searchQuery=s},handleColorFilter(s){this.selectedColors=s}}},A={class:"row q-mb-md items-center"},H={class:"col-grow"},j={class:"col-auto q-ml-md"},R={key:0,class:"text-center q-pa-md"},W={class:"col-12 col-sm-6 col-md-4 col-lg-3"},X={class:"drag-handle"},Y={class:"text-h6"},Z={class:"text-subtitle2"},$={class:"text-h6",style:{color:"var(--secondary-color)"}},ee={class:"row items-center"},re={class:"col-12 col-sm-6"},se={class:"text-subtitle1"},te={class:"col-12 col-sm-6"};function oe(s,e,i,d,o,c){const b=w("color-filter"),K=w("keycap-color-extractor"),S=w("draggable");return n(),m(E,{class:"q-pa-md"},{default:t(()=>[e[11]||(e[11]=a("h1",{class:"text-h4 q-mb-md"},"Keycaps Collection",-1)),a("div",A,[a("div",H,[r(q,{modelValue:o.searchQuery,"onUpdate:modelValue":e[3]||(e[3]=l=>o.searchQuery=l),filled:"",placeholder:"搜索键帽名称或制造商",clearable:"",onClear:c.onClear},{append:t(()=>[r(y,{name:"search"})]),hint:t(()=>[f(" 已找到 "+u(c.filteredKeycaps.length)+" 个键帽 ",1)]),after:t(()=>[r(M,{flat:"",dense:"",style:{color:"var(--secondary-color)"},label:"快速筛选"},{default:t(()=>[r(D,null,{default:t(()=>[_((n(),m(C,{clickable:"",style:{color:"var(--secondary-color)"},onClick:e[0]||(e[0]=l=>c.filterByManufacturer("GMK"))},{default:t(()=>[r(k,null,{default:t(()=>[r(Q,null,{default:t(()=>e[7]||(e[7]=[f("GMK")])),_:1})]),_:1})]),_:1})),[[p]]),_((n(),m(C,{clickable:"",style:{color:"var(--secondary-color)"},onClick:e[1]||(e[1]=l=>c.filterByManufacturer("JTK"))},{default:t(()=>[r(k,null,{default:t(()=>[r(Q,null,{default:t(()=>e[8]||(e[8]=[f("JTK")])),_:1})]),_:1})]),_:1})),[[p]]),r(B),_((n(),m(C,{clickable:"",style:{color:"var(--secondary-color)"},onClick:e[2]||(e[2]=l=>o.searchQuery="")},{default:t(()=>[r(k,null,{default:t(()=>[r(Q,null,{default:t(()=>e[9]||(e[9]=[f("显示全部")])),_:1})]),_:1})]),_:1})),[[p]])]),_:1})]),_:1})]),_:1},8,["modelValue","onClear"])]),a("div",j,[r(g,{flat:"",style:{color:"var(--secondary-color)"},class:"sort-btn",onClick:c.toggleSort},{default:t(()=>[r(y,{name:o.sortOrder==="asc"?"arrow_upward":"arrow_downward",class:"q-mr-sm"},null,8,["name"]),f(" ID "+u(o.sortOrder==="asc"?"升序":"降序"),1)]),_:1},8,["onClick"])])]),r(b,{keycaps:o.keycaps,onFilterChange:c.handleColorFilter},null,8,["keycaps","onFilterChange"]),o.searchQuery&&c.filteredKeycaps.length===0?(n(),G("div",R,[r(y,{name:"search_off",size:"48px",style:{color:"var(--secondary-color)"}}),e[10]||(e[10]=a("p",{class:"text",style:{color:"var(--secondary-color)"}},"未找到匹配的键帽",-1))])):F("",!0),r(S,{modelValue:c.filteredKeycaps,"onUpdate:modelValue":e[4]||(e[4]=l=>c.filteredKeycaps=l),class:"row q-col-gutter-md",style:{color:"var(--secondary-color)"},"item-key":"id",onStart:e[5]||(e[5]=l=>o.drag=!0),onEnd:c.onDragEnd,group:{name:"keycaps"}},{item:t(({element:l})=>[a("div",W,[r(x,{class:"keycap-card",style:{"background-color":"var(--l9)"}},{default:t(()=>[a("div",X,[r(y,{name:"drag_indicator",size:"sm",class:"cursor-move"})]),r(O,{src:l.image,class:"keycap-image",ratio:1},null,8,["src"]),r(h,null,{default:t(()=>[a("div",Y,u(l.name),1),a("div",Z,u(l.manufacturer),1),r(K,{"image-src":l.image},null,8,["image-src"])]),_:2},1024),r(P,{align:"right"},{default:t(()=>[r(g,{icon:"zoom_in",flat:"",round:"",onClick:I=>c.showPreview(l),style:{color:"var(--secondary-color)"}},null,8,["onClick"]),r(g,{icon:l.isFavorite?"favorite":"favorite_border",flat:"",round:"",onClick:I=>c.toggleFavorite(l),color:l.isFavorite?"red":"grey"},null,8,["icon","onClick","color"])]),_:2},1024)]),_:2},1024)])]),_:1},8,["modelValue","onEnd"]),r(J,{modelValue:o.previewDialog,"onUpdate:modelValue":e[6]||(e[6]=l=>o.previewDialog=l)},{default:t(()=>[r(x,{class:"preview-card"},{default:t(()=>[r(h,{class:"row items-center q-pb-none"},{default:t(()=>[a("div",$,u(o.selectedKeycap?.name),1),r(L),_(r(g,{style:{color:"var(--secondary-color)"},icon:"close",flat:"",round:"",dense:""},null,512),[[p]])]),_:1}),r(h,null,{default:t(()=>[r(O,{src:o.selectedKeycap?.image,style:{"max-height":"80vh"},fit:"contain"},null,8,["src"])]),_:1}),r(h,null,{default:t(()=>[a("div",ee,[a("div",re,[a("div",se,"制造商: "+u(o.selectedKeycap?.manufacturer),1)]),a("div",te,[o.selectedKeycap?(n(),m(K,{key:0,"image-src":o.selectedKeycap.image},null,8,["image-src"])):F("",!0)])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const ue=V(U,[["render",oe],["__scopeId","data-v-f1d9cc10"]]);export{ue as default};
