import{_ as S,Q as f,g as y}from"./_plugin-vue_export-helper-DoYapf4v.js";import{o as x,e as _,g as k,f as Q,Q as I}from"./selection-DvsxRTGy.js";import{d as F,Q as V,a as D,C as g,b as B,c as N}from"./vuedraggable.umd-BXLkE0Fg.js";import{Q as q,k as p,a as C,b as O,c as w,d as J}from"./keycaps-BSPX8J5e.js";import{G as v,H as n,I as t,J as L,M as d,N as M,O as P,K as r,k as h,L as u,P as m}from"./index-CsPf3d5g.js";const E={name:"PageIndex",components:{draggable:F},data(){return{searchQuery:"",keycaps:[],previewDialog:!1,selectedKeycap:null,sortOrder:"asc",drag:!1}},created(){this.keycaps=p.getAllKeycaps();const s=localStorage.getItem("keycapsOrder");if(s){const i=JSON.parse(s).map(c=>c.id);this.keycaps.sort((c,a)=>i.indexOf(c.id)-i.indexOf(a.id))}const e=p.getFavorites();this.keycaps=this.keycaps.map(i=>({...i,isFavorite:e.some(c=>c.id===i.id)}))},watch:{keycaps:{handler(s){localStorage.setItem("keycapsOrder",JSON.stringify(s))},deep:!0}},computed:{filteredKeycaps:{get(){return this.drag?this.keycaps:this.keycaps.filter(s=>{const e=this.searchQuery.toLowerCase();return s.name.toLowerCase().includes(e)||s.manufacturer.toLowerCase().includes(e)}).sort((s,e)=>this.sortOrder==="asc"?s.id-e.id:e.id-s.id)},set(s){this.keycaps=s}}},methods:{toggleFavorite(s){s.isFavorite=!s.isFavorite,s.isFavorite?p.addToFavorites(s):p.removeFromFavorites(s.id)},showPreview(s){this.selectedKeycap=s,this.previewDialog=!0},toggleSort(){this.sortOrder==="asc"?this.sortOrder="desc":this.sortOrder==="desc"&&(this.sortOrder="asc");const s=[...this.keycaps].sort((e,i)=>this.sortOrder==="asc"?e.id-i.id:i.id-e.id);this.keycaps=s,localStorage.setItem("keycapsOrder",JSON.stringify(s))},onDragEnd(){this.drag=!1,localStorage.setItem("keycapsOrder",JSON.stringify(this.keycaps))},onClear(){this.searchQuery=""},filterByManufacturer(s){this.searchQuery=s}}},T={class:"row q-mb-md items-center"},z={class:"col-grow"},G={class:"col-auto q-ml-md"},U={key:0,class:"text-center q-pa-md"},A={class:"col-12 col-sm-6 col-md-4 col-lg-3"},H={class:"drag-handle"},j={class:"text-h6"},R={class:"text-subtitle2"},W={class:"text-h6",style:{color:"var(--secondary-color)"}};function X(s,e,i,c,a,l){const K=L("draggable");return n(),v(q,{class:"q-pa-md"},{default:t(()=>[e[11]||(e[11]=d("h1",{class:"text-h4 q-mb-md"},"Keycaps Collection",-1)),d("div",T,[d("div",z,[r(V,{modelValue:a.searchQuery,"onUpdate:modelValue":e[3]||(e[3]=o=>a.searchQuery=o),filled:"",placeholder:"搜索键帽名称或制造商",clearable:"",onClear:l.onClear},{append:t(()=>[r(f,{name:"search"})]),hint:t(()=>[u(" 已找到 "+m(l.filteredKeycaps.length)+" 个键帽 ",1)]),after:t(()=>[r(D,{flat:"",dense:"",style:{color:"var(--secondary-color)"},label:"快速筛选"},{default:t(()=>[r(x,null,{default:t(()=>[h((n(),v(_,{clickable:"",style:{color:"var(--secondary-color)"},onClick:e[0]||(e[0]=o=>l.filterByManufacturer("GMK"))},{default:t(()=>[r(k,null,{default:t(()=>[r(Q,null,{default:t(()=>e[7]||(e[7]=[u("GMK")])),_:1})]),_:1})]),_:1})),[[g]]),h((n(),v(_,{clickable:"",style:{color:"var(--secondary-color)"},onClick:e[1]||(e[1]=o=>l.filterByManufacturer("JTK"))},{default:t(()=>[r(k,null,{default:t(()=>[r(Q,null,{default:t(()=>e[8]||(e[8]=[u("JTK")])),_:1})]),_:1})]),_:1})),[[g]]),r(I),h((n(),v(_,{clickable:"",style:{color:"var(--secondary-color)"},onClick:e[2]||(e[2]=o=>a.searchQuery="")},{default:t(()=>[r(k,null,{default:t(()=>[r(Q,null,{default:t(()=>e[9]||(e[9]=[u("显示全部")])),_:1})]),_:1})]),_:1})),[[g]])]),_:1})]),_:1})]),_:1},8,["modelValue","onClear"])]),d("div",G,[r(y,{flat:"",style:{color:"var(--secondary-color)"},class:"sort-btn",onClick:l.toggleSort},{default:t(()=>[r(f,{name:a.sortOrder==="asc"?"arrow_upward":"arrow_downward",class:"q-mr-sm"},null,8,["name"]),u(" ID "+m(a.sortOrder==="asc"?"升序":"降序"),1)]),_:1},8,["onClick"])])]),a.searchQuery&&l.filteredKeycaps.length===0?(n(),M("div",U,[r(f,{name:"search_off",size:"48px",style:{color:"var(--secondary-color)"}}),e[10]||(e[10]=d("p",{class:"text",style:{color:"var(--secondary-color)"}},"未找到匹配的键帽",-1))])):P("",!0),r(K,{modelValue:l.filteredKeycaps,"onUpdate:modelValue":e[4]||(e[4]=o=>l.filteredKeycaps=o),class:"row q-col-gutter-md",style:{color:"var(--secondary-color)"},"item-key":"id",onStart:e[5]||(e[5]=o=>a.drag=!0),onEnd:l.onDragEnd,group:{name:"keycaps"}},{item:t(({element:o})=>[d("div",A,[r(C,{class:"keycap-card",style:{"background-color":"var(--l9)"}},{default:t(()=>[d("div",H,[r(f,{name:"drag_indicator",size:"sm",class:"cursor-move"})]),r(O,{src:o.image,class:"keycap-image",ratio:1},null,8,["src"]),r(w,null,{default:t(()=>[d("div",j,m(o.name),1),d("div",R,m(o.manufacturer),1)]),_:2},1024),r(J,{align:"right"},{default:t(()=>[r(y,{icon:"zoom_in",flat:"",round:"",onClick:b=>l.showPreview(o),style:{color:"var(--secondary-color)"}},null,8,["onClick"]),r(y,{icon:o.isFavorite?"favorite":"favorite_border",flat:"",round:"",onClick:b=>l.toggleFavorite(o),color:o.isFavorite?"red":"grey"},null,8,["icon","onClick","color"])]),_:2},1024)]),_:2},1024)])]),_:1},8,["modelValue","onEnd"]),r(B,{modelValue:a.previewDialog,"onUpdate:modelValue":e[6]||(e[6]=o=>a.previewDialog=o)},{default:t(()=>[r(C,{class:"preview-card"},{default:t(()=>[r(w,{class:"row items-center q-pb-none"},{default:t(()=>[d("div",W,m(a.selectedKeycap?.name),1),r(N),h(r(y,{style:{color:"var(--secondary-color)"},icon:"close",flat:"",round:"",dense:""},null,512),[[g]])]),_:1}),r(w,null,{default:t(()=>[r(O,{src:a.selectedKeycap?.image,style:{"max-height":"80vh"},fit:"contain"},null,8,["src"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const se=S(E,[["render",X],["__scopeId","data-v-9f5a683e"]]);export{se as default};
